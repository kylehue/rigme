"use strict";var currentJSON,yj=require("yieldable-json"),events=require("../../../../lib/events.js"),dom=require("../../../../lib/dom.js"),loadApp=new Vue({el:"#loadApp",data:{hidden:!0,closeMsg:"Close",errorMessage:"",fileError:!1},methods:{show:function(){var e=this;this.hidden=!1,this.$nextTick(function(){e.$el.style.opacity="1",dom.query("#loadApp .drag").draggable({restrict:!0,root:e.$el}),events.emit("renderSleep")})},hide:function(){currentJSON=void 0,events.emit("renderFocus"),dom.query("#import").addClass("disabled"),this.fileError=!1,this.hidden=!0},checkFile:function(){var e,t,i=this,r=dom.query("#importInput"),s=dom.query("#loadFilename"),d=r.node.files[0];d&&(r=(e=d.name).split(".")[e.split(".").length-1],(t=dom.query("#import")).addClass("disabled"),t.text("Processing...",!0),"rigme"==r&&(s.text(e,!0),(d=URL.createObjectURL(d))&&fetch(d).then(function(e){e.text().then(function(e){try{yj.parseAsync(e,function(e,r){e?0:(currentJSON=r,t.text("Load",!0),t.removeClass("disabled"),i.fileError=!1)})}catch(e){t.addClass("disabled"),i.errorMessage="This file is corrupted.",i.fileError=!0}})})))},validate:function(){currentJSON&&(events.emit("loadProject",currentJSON),this.hide())}}});module.exports=loadApp;